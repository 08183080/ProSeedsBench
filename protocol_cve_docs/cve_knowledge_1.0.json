{
    "cve_knowledge_base": {
      "meta": {
        "version": "1.0",
        "author": "xpg,gemini-3.5-pro",
        "date": "2025-12-07",
        "purpose": "LLM-guided protocol fuzzing configuration derived from historical CVEs.",
        "target_agents": ["Protocol_Grammar_Agent", "Mutation_Agent", "State_Machine_Agent"]
      },
      "protocols": [
        {
          "protocol": "SMTP",
          "target_software": ["Exim"],
          "default_port": 25,
          "attack_vectors": [
            {
              "cve_id": "CVE-2020-28021",
              "vulnerability_type": "New-line Injection / xtext Decoding",
              "critical_state": "MAIL_TRANSACTION",
              "trigger_primitive": "xtext encoded control characters",
              "message_template": "MAIL FROM:<{sender}> AUTH={malicious_param}",
              "concrete_payload_example": "MAIL FROM:<> AUTH=x+0AXX+0A1+0Aattacker@fake.com+208192,-1#1+0A+0A990*",
              "description": "Inject '+0A' (newline) or '+00' into AUTH parameters. Exim decodes these during spool write, corrupting the spool file structure[cite: 231, 241]."
            },
            {
              "cve_id": "CVE-2020-28020",
              "vulnerability_type": "Integer Overflow / Header Parsing",
              "critical_state": "DATA_TRANSFER",
              "trigger_primitive": "Continuation Lines Expansion",
              "message_template": "{Header_Name}: {Value}\\r\\n {Continuation}",
              "concrete_payload_example": "X-Overflow: data\\r\\n continued_line_data...[repeated > 512MB equivalent]",
"description": "Use continuation lines (newline followed by space) to send massive headers (>1MB limit) that bypass initial size checks but overflow internal counters[cite: 177, 187]."
            },
            {
              "cve_id": "CVE-2020-28017",
              "vulnerability_type": "Integer Overflow",
              "critical_state": "RCPT_TO",
              "trigger_primitive": "Excessive Recipients",
              "message_template": "RCPT TO:<{recipient}>",
              "concrete_payload_example": "[Send 50,000,001 RCPT TO commands in a single session]",
"description": "Exceeding 50 million recipients causes an integer overflow in the memory allocation size calculation (recipients_count * sizeof(recipient_item))[cite: 152, 153]."
            },
            {
              "cve_id": "CVE-2020-28022",
              "vulnerability_type": "Heap Out-of-bounds Read/Write",
              "critical_state": "MAIL_FROM / RCPT_TO",
              "trigger_primitive": "Backtracking Parsing Logic",
              "message_template": "MAIL FROM:<{sender}> {param_name}={param_value}",
              "concrete_payload_example": "MAIL FROM:<> SIZE=1234 AUTH=...[quote backtracking]...",
"description": "The function extract_option() mishandles backtracking when parsing quoted parameters, allowing pointers to move before the start of the buffer[cite: 243, 244]."
            }
          ],
          "implementation_quirks": {
            "magic_values": [
              {
                "value": 16384,
                "context": "big_buffer_size in spool_read_header",
                "type": "hard_buffer_limit",
"description": "Fuzz inputs around 16KB boundaries (16383, 16385) to test buffer expansion logic[cite: 253]."
              },
              {
                "value": 256,
                "context": "LOG_NAME_SIZE",
                "type": "stack_buffer_limit",
"description": "Filenames or log tags > 256 bytes may overflow stack buffers in logging functions[cite: 134]."
              },
              {
                "value": 52428800,
                "context": "message_size_limit (50MB)",
                "type": "config_limit",
                "description": "Default message size limit. Surpassing this may trigger specific error paths like BDAT reset failures[cite: 279]."
              }
            ],
            "encoding_quirks": [
              {
                "rule": "xtext",
"description": "Hex encoding with '+' prefix (e.g., +0A for \\n, +20 for space) used in AUTH parameters[cite: 231]."
              },
              {
                "rule": "Format String NOP",
                "description": "%0Lu or %.0D acts as a NOP in Exim's string_format, consuming arguments without output. Useful for stack alignment[cite: 135]."
              }
            ],
            "target_functions": [
              "auth_xtextdecode",
              "receive_msg",
              "smtp_setup_msg",
              "extract_option"
            ]
          },
          "state_interactions": [
            {
              "scenario": "BDAT_Function_Pointer_Confusion",
              "sequence": ["EHLO", "MAIL FROM", "RCPT TO", "BDAT {size} LAST", "[Trigger Error/Interrupt]", "MAIL FROM"],
              "description": "Send BDAT, trigger an error (e.g., size limit), then send standard ASCII commands without resetting connection. The input handler may remain in 'bdat_getc' mode[cite: 277, 283]."
            },
            {
              "scenario": "Pipelining_UAF",
              "sequence": ["EHLO", "STARTTLS", "MAIL FROM", "[Half NOOP]", "[Close TLS]", "[Other Half NOOP]", "EHLO", "STARTTLS"],
"description": "Pipeline commands across TLS toggling to trigger Use-After-Free in the 'server_corked' buffer[cite: 319]."
            },
            {
              "scenario": "Premature_RCPT",
              "sequence": ["EHLO", "RCPT TO"],
"description": "Sending RCPT TO before MAIL FROM allows out-of-bounds read in smtp_setup_msg[cite: 217, 218]."
            }
          ]
        },
        {
          "protocol": "RTSP",
          "target_software": ["Live555"],
          "default_port": 554,
          "attack_vectors": [
            {
              "cve_id": "CVE-2019-7733",
              "vulnerability_type": "Buffer Overflow",
              "critical_state": "ANY",
              "trigger_primitive": "Large Integer Injection",
              "message_template": "Content-Length: {huge_integer}",
              "concrete_payload_example": "Content-Length: 4294967296",
"description": "Inject integer values larger than MAX_INT (or negative) into Content-Length to trigger overflow in 'handleRequestBytes'[cite: 417]."
            },
            {
              "cve_id": "CVE-2013-6933",
              "vulnerability_type": "Integer Underflow / Parsing Error",
              "critical_state": "INITIAL_REQUEST",
              "trigger_primitive": "Leading Whitespace",
              "message_template": "{whitespace}{Method} {Url} RTSP/1.0",
              "concrete_payload_example": " DESCRIBE rtsp://127.0.0.1:8554/stream RTSP/1.0",
              "description": "Start the RTSP message with a Space or Tab character. This triggers an integer underflow because the parser assumes the method starts at index 0[cite: 411]."
            },
            {
              "cve_id": "CVE-2021-38381",
              "vulnerability_type": "Use-After-Free",
              "critical_state": "SETUP_PHASE",
              "trigger_primitive": "Duplicate State Command",
              "message_template": "SETUP {url} RTSP/1.0\\r\\n...\\r\\nSETUP {url} RTSP/1.0...",
              "concrete_payload_example": "[Send identical SETUP command twice for the same track ID]",
"description": "Sending two successive SETUP commands for the same track causes a Use-After-Free crash[cite: 423]."
            }
          ],
          "state_interactions": [
            {
              "scenario": "HTTP_Tunneling_Confusion",
              "sequence": ["GET {url}", "POST {url}"],
"description": "Send a GET request and a POST request within the same TCP session using 'x-sessioncookie' headers to crash RTSP-over-HTTP tunneling[cite: 414]."
            }
          ]
        },
        {
          "protocol": "FTP",
          "target_software": ["ProFTPD", "Pure-FTPd", "Bftpd"],
          "default_port": 21,
          "attack_vectors": [
            {
              "cve_id": "CVE-2023-51713",
              "vulnerability_type": "Out-of-Bounds Read",
              "critical_state": "AUTHENTICATED",
              "trigger_primitive": "Quote/Backslash Collision",
              "message_template": "{COMMAND} {ARGUMENT}",
              "concrete_payload_example": "CWD \"folder\\\"",
"description": "Mishandling of quote/backslash semantics at the end of arguments in 'make_ftp_cmd'[cite: 492]."
            },
            {
              "cve_id": "CVE-2011-0418",
              "vulnerability_type": "DoS / Memory Exhaustion",
              "critical_state": "AUTHENTICATED",
              "trigger_primitive": "Recursive Globbing",
              "message_template": "STAT {glob_pattern}",
              "concrete_payload_example": "STAT */../../../../../../../../",
"description": "Use extensive globbing patterns (e.g., curly brackets, wildcards) in commands like STAT or LIST to exhaust memory[cite: 507]."
            },
            {
              "cve_id": "CVE-2001-0065",
              "vulnerability_type": "Buffer Overflow",
              "critical_state": "AUTHENTICATED",
              "trigger_primitive": "Long SITE Command",
              "message_template": "SITE CHOWN {payload}",
              "concrete_payload_example": "SITE CHOWN AAAAA...[repeated 4096+ times]... file",
"description": "SITE CHOWN command in Bftpd allows remote attackers to cause buffer overflow via long arguments[cite: 363]."
            }
          ],
          "implementation_quirks": {
            "magic_values": [
              {
                "value": 1024,
                "context": "_xlate_ascii_write buffer",
                "type": "off_by_one_limit",
"description": "Files exactly 1024 bytes transferred in ASCII mode (RETR) can trigger off-by-one overflows in ProFTPD[cite: 450]."
              }
            ],
            "target_functions": [
              "make_ftp_cmd",
              "sreplace",
              "pr_data_xfer"
            ]
          }
        },
        {
          "protocol": "SIP",
          "target_software": ["Kamailio"],
          "default_port": 5060,
          "attack_vectors": [
            {
              "cve_id": "CVE-2020-28361",
              "vulnerability_type": "Header Parsing Bypass",
              "critical_state": "PROXY",
              "trigger_primitive": "Whitespace Injection",
              "message_template": "{Header_Name}{Whitespace}: {Value}",
              "concrete_payload_example": "Remove-Header  : value",
"description": "Inject whitespace characters between header name and colon to bypass header-removal protection mechanisms[cite: 385]."
            },
            {
              "cve_id": "CVE-2018-14767",
              "vulnerability_type": "Segmentation Fault",
              "critical_state": "PROCESSING",
              "trigger_primitive": "Duplicate Header / Empty Tag",
              "message_template": "To: {uri}\\r\\nTo: {uri};tag=",
              "concrete_payload_example": "To: <sip:a@b>\r\nTo: <sip:a@b>;tag=",
"description": "A crafted SIP message with a double 'To' header and an empty 'To' tag causes a crash[cite: 383]."
            },
            {
              "cve_id": "CVE-2018-8828",
              "vulnerability_type": "Off-by-one Heap Overflow",
              "critical_state": "REGISTER",
              "trigger_primitive": "Malformed Branch/From Tag",
              "message_template": "REGISTER sip:{uri} SIP/2.0\\r\\nFrom: {uri};tag={malformed_tag}",
"description": "A REGISTER message with a malformed branch or From tag triggers an off-by-one overflow in 'tmx_check_pretran'[cite: 382]."
            }
          ]
        },
        {
          "protocol": "HTTP",
          "target_software": ["Lighttpd"],
          "default_port": 80,
          "attack_vectors": [
            {
              "cve_id": "CVE-2025-12642",
              "vulnerability_type": "HTTP Request Smuggling",
              "critical_state": "REQUEST_PARSING",
              "trigger_primitive": "Trailer Field Merging",
              "message_template": "Transfer-Encoding: chunked\\r\\n\\r\\n0\\r\\n{Trailer}: {Value}\\r\\n\\r\\n",
"description": "Exploit incorrect merging of trailer fields into headers to conduct HTTP Header Smuggling attacks[cite: 409]."
            }
          ]
        }
      ]
    }
  }